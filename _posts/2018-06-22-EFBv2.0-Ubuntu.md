---
layout: post
title: EFB V2.0 Ubuntu éƒ¨ç½²æ–¹æ³•
date: 2018-06-22
description: åœ¨ Ubuntu ä¸Šéƒ¨ç½² EhForwarderBotï¼Œå®ç°ä»å¾®ä¿¡åˆ° Telegram çš„è¿ç§»
tags:
 - æ•™ç¨‹
---

ğŸ†— åœ¨ Ubuntu ä¸Šéƒ¨ç½² EhForwarderBotï¼Œå®ç°ä»å¾®ä¿¡åˆ° Telegram çš„è¿ç§»

<!--more-->

ğŸ“Œ **æ›´æ–°æ—¥å¿—:**

* 2018-06-22

bugï¼šå‘é€ `/link` æˆ– `/chat` æŒ‡ä»¤åä¸€ç›´æ˜¾ç¤ºåœ¨å¤„ç†ä¸­ï¼Œlogæ—¥å¿—è¾“å‡º Nonetype é”™è¯¯  
çŠ¶æ€: å·²ä¿®å¤

* 2018-04-30

Ubuntu 18.04 æµ‹è¯•é€šè¿‡ï¼Œä¿®æ”¹äº†è¿›å…¥ miniconda ç¯å¢ƒçš„å‘½ä»¤ã€‚

ğŸ“Œ **è¯¦ç»†è§£å†³æ–¹æ¡ˆï¼š**

```bash
# [zh-cn]å‰è¨€ï¼šä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•ä¸€æ­¥ä¸€æ­¥åœ¨æœåŠ¡å™¨é…ç½®EFB
# [en]Prefix: You can follow the commands to set up your EFB on your VPS.
# [zh-cn]æ³¨æ„ï¼šè¿™ä¸æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œä»…æä¾›æ€è·¯å’Œæ­¥éª¤å‚è€ƒ
# [en]Caution: This is not a sh file, only cover with my way to success.
# Ubuntu 16.04.3 LTS / 18.04 LTS with sudo

# [zh-cn]é¦–å…ˆï¼Œå‡çº§ä½ çš„è½¯ä»¶åŒ…å¹¶å®‰è£…æ‰€éœ€çš„ä¾èµ–
sudo apt update && sudo apt upgrade -y && 
sudo apt install wget curl screen vim ffmpeg libmagic-dev libwebp-dev libsqlite3-dev -y

# [zh-cn]ä¸‹è½½Minicondaå¹¶å®‰è£…
wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash ./Miniconda3-latest-Linux-x86_64.sh

# [en]Restart your terminal
# [en]If you are connect with ssh, you should first `exit` and then `ssh ip` again
conda create -n efb pip
source activate efb

# [zh-cn]è¿™æ˜¯pythonç¯å¢ƒå®‰è£…çš„æ›¿ä»£æ–¹æ³•ï¼Œå¦‚æœä¸Šé¢çš„minicondaæ— æ³•æ­£å¸¸å®‰è£…ï¼Œè¯·å‚è€ƒè¿™é‡Œ
# curl -L https://raw.githubusercontent.com/pyenv/pyenv-installer/master/bin/pyenv-installer | bash
# export PATH="$HOME/.pyenv/bin:$PATH"
# eval "$(pyenv init -)"
# eval "$(pyenv virtualenv-init -)"
# pyenv install 3.6.4
# pyenv global 3.6.4

# [zh-cn]æ¥ç€ä½ éœ€è¦åœ¨Telegramè·å–åˆ°ä½ çš„bot apiã€botç®¡ç†å‘˜id
# [en]for TG bot token and admin id, you can refer to this url: https://www.ynewtime.com/EFB-sh
export TGBOTTOKEN=""
export TGADMIN=""

# [zh-cn]åˆå§‹åŒ–pythonç¯å¢ƒå¹¶å®‰è£…ehforwarderbot
pip install ehforwarderbot efb-telegram-master efb-wechat-slave

# [zh-cn]åˆ›å»ºå¹¶å†™å…¥EFBçš„é…ç½®æ–‡ä»¶
mkdir -p ~/.ehforwarderbot/profiles/default/blueset.telegram

cat>~/.ehforwarderbot/profiles/default/config.yaml<<EOF
master_channel: "blueset.telegram"
slave_channels:
- "blueset.wechat"
EOF

cat>~/.ehforwarderbot/profiles/default/blueset.telegram/config.yaml<<EOF
token: "$TGBOTTOKEN"
admins:
- $TGADMIN
EOF

# [zh-cn]ä½¿ç”¨screenå¯åŠ¨ehforwarderbot
# [zh-cn]æ³¨æ„ï¼šå¯åŠ¨æˆåŠŸåé€€å‡ºscreenç¯å¢ƒè¦ç”¨å¿«æ·é”®ctrl+a -> ctrl+d
# [en]press ctrl+a and ctrl+d to go back to terminal
# [zh-cn]æ³¨æ„ï¼šctrl+cä¼šå¯¼è‡´screenè¿›ç¨‹ç»ˆæ­¢ï¼Œè¯·è°¨æ…ä½¿ç”¨
screen ehforwarderbot

# enjoy
```

æœ¬æ–‡æ”¶å½•äº ã€[äº’è”ç½‘ç¤¾åŒºè´¡çŒ®çš„èµ„æº](https://github.com/blueset/efb-wechat-slave/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%8A%E7%A4%BE%E5%8C%BA%E8%B4%A1%E7%8C%AE%E7%9A%84%E8%B5%84%E6%BA%90)ã€‘